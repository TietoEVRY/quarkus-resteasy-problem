java_ver=$(java -version 2>&1 | head -1 | cut -d'"' -f2 | sed '/^1\./s///' | cut -d'.' -f1)
if [[ "$java_ver" != "8" ]]; then
    echo "Expected Java version is 1.8, while $java_ver was found"
    exit;
fi

./mvnw clean install -Pquick

./mvnw clean verify -Pjackson-classic -pl integration-test
./mvnw clean verify -Pjackson-reactive -pl integration-test
./mvnw clean verify -Pjsonb-classic -pl integration-test
./mvnw clean verify -Pjsonb-reactive -pl integration-test

./mvnw clean verify -Pjackson-classic,quarkus-1.4 -pl integration-test
./mvnw clean verify -Pjsonb-classic,quarkus-1.4 -pl integration-test